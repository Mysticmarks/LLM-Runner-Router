#!/bin/bash
# Pre-bash hook - runs before Claude executes bash commands

# Check for potentially destructive operations
if echo "$CLAUDE_BASH_COMMAND" | grep -E "(rm -rf|sudo|chmod 777|> /dev)" > /dev/null; then
    echo "âš ï¸  DESTRUCTIVE COMMAND DETECTED: $CLAUDE_BASH_COMMAND"
    echo "ğŸ›¡ï¸  Please review this command carefully before proceeding"
fi

# Check for package operations
if echo "$CLAUDE_BASH_COMMAND" | grep -E "(npm install|npm uninstall|npm update)" > /dev/null; then
    echo "ğŸ“¦ Package operation detected - backing up package-lock.json"
    [ -f "package-lock.json" ] && cp package-lock.json package-lock.json.backup
fi

# Monitor long-running operations
if echo "$CLAUDE_BASH_COMMAND" | grep -E "(npm start|npm run dev|node.*--watch)" > /dev/null; then
    echo "ğŸƒ Long-running process detected"
    echo "ğŸ’¡ Use Ctrl+C to stop when needed"
fi

# Check for model downloads
if echo "$CLAUDE_BASH_COMMAND" | grep -E "(curl.*huggingface|wget.*models|git clone.*model)" > /dev/null; then
    echo "â¬‡ï¸  Model download detected"
    echo "ğŸ’¾ Ensure sufficient disk space (models can be several GB)"
    df -h . | tail -1 | awk '{print "Available space: " $4}'
fi